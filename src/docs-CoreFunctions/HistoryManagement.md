---
author:
  - name: 本新同学
    url: https://github.com/yuanbenxin/
  - name: 黎泽懿
    url: https://github.com/lzy98276
order: 5    
---
# 历史记录管理
::: warning
本页面尚未完善，因此缺少图片描述，部分内容可能存在缺失和谬误，我们将陆续修正。
:::
历史记录管理是SecRandom软件的重要功能模块，负责记录、存储和管理所有随机选择操作的结果。通过本章内容，您将了解如何高效地查看、导出、备份和清理历史记录，确保数据安全和操作可追溯性。所有历史记录均采用结构化存储，包含操作时间、参与名单、抽取结果、使用设置等完整信息。

## 6.1 历史记录概述

### 6.1.1 记录内容
历史记录包含以下核心信息，确保每次随机选择操作的完全可追溯：

- **基本信息**：操作时间戳、操作类型（抽人/抽奖）、操作结果状态
- **参与数据**：完整参与名单（包含所有参与人员/奖品信息）
- **设置参数**：操作时使用的所有设置（抽取人数、概率设置、动画效果等）
- **结果详情**：抽取结果（含顺序）、重复抽取情况、特殊标记
- **关联文件**：相关的导入文件、导出文件路径记录
- **操作日志**：操作过程中的用户交互记录

### 6.1.2 存储方式
- **数据格式**：采用SQLite数据库存储，确保数据完整性和查询效率
- **存储位置**：默认位于软件数据目录下的`history.db`文件中
- **数据安全**：支持加密存储，保护敏感历史记录信息
- **备份机制**：自动创建定期备份，防止数据丢失

### 6.1.3 历史记录界面
历史记录管理界面由以下关键区域组成：

- **工具栏**：包含搜索、筛选、导出、清理等核心操作按钮
- **筛选面板**：提供多维度筛选条件设置区域
- **记录列表**：以表格形式展示历史记录摘要信息
- **详情面板**：选中记录后显示的详细信息区域
- **操作日志**：显示当前记录的操作历史和状态变化

## 6.2 查看历史记录

### 6.2.1 基本浏览
- **列表视图**：默认以表格形式展示所有历史记录，包含以下列：
  - 时间戳：操作发生的具体日期和时间
  - 类型：标识为"抽人"或"抽奖"操作
  - 描述：自动生成的操作描述（如"抽取10名幸运观众"）
  - 状态：操作状态（成功/部分成功/失败）
  - 操作：快捷操作按钮（查看详情/导出/删除）
- **排序方式**：支持按时间戳（默认）、操作类型、结果状态等字段排序
- **分页控制**：默认每页显示20条记录，可调整为10/20/50/100条/页
- **视图切换**：支持列表视图和卡片视图两种浏览模式

### 6.2.2 高级筛选
通过多维度筛选快速定位所需历史记录：

#### 时间筛选
- **预设时间范围**：今天、昨天、近7天、近30天、本月、上月、今年
- **自定义时间范围**：精确选择开始日期和结束日期
- **时间粒度**：可按年、月、日、小时级别筛选
- **相对时间**：支持"过去X小时/天/月"等相对时间筛选

#### 类型筛选
- **操作类型**：抽人记录、抽奖记录
- **结果状态**：全部状态、成功、部分成功、失败
- **参与规模**：按参与人数/奖品数量筛选（如：参与人数>50）
- **操作来源**：手动操作、自动任务、API调用

#### 高级条件筛选
- **关键词搜索**：在记录描述、结果等字段中搜索关键词
- **设置筛选**：按特定设置参数筛选（如：使用了特定名单的记录）
- **结果筛选**：按包含特定结果的记录筛选
- **组合条件**：支持多条件组合筛选（AND/OR逻辑）

### 6.2.3 记录详情查看
查看单条历史记录的完整信息：

#### 详情面板内容
- **基本信息区**：显示操作时间、类型、状态等概览信息
- **参与数据区**：展示完整参与名单（可分页浏览大量数据）
- **结果展示区**：以清晰格式展示抽取结果，包含顺序标识
- **设置详情区**：展示操作时使用的所有设置参数
- **操作日志区**：记录该历史记录的后续操作（如导出、备份）

#### 详情操作功能
- **复制结果**：一键复制抽取结果文本
- **重新抽取**：基于相同名单和设置再次执行抽取
- **导出详情**：导出当前记录的详细信息
- **删除记录**：从历史记录中删除当前记录
- **添加备注**：为当前记录添加自定义备注信息
- **查看关联文件**：访问相关的导入/导出文件

## 6.3 搜索历史记录

### 6.3.1 基本搜索
- **搜索框**：位于界面顶部的全局搜索框
- **搜索范围**：默认搜索所有文本字段
- **即时搜索**：输入时实时显示匹配结果
- **搜索历史**：自动保存搜索关键词，支持快速重新搜索

### 6.3.2 高级搜索
通过高级搜索对话框进行精准搜索：

- **搜索字段选择**：可指定在哪些字段中搜索（描述/结果/备注等）
- **搜索模式**：
  - 精确匹配：完全匹配搜索词
  - 模糊匹配：包含搜索词的记录
  - 正则表达式：使用正则表达式进行复杂模式匹配
- **大小写敏感**：可选择是否区分大小写
- **搜索结果高亮**：搜索关键词在结果中高亮显示

### 6.3.3 搜索结果处理
- **结果统计**：显示匹配结果总数和分布情况
- **结果保存**：可保存搜索条件为"搜索模板"，便于下次使用
- **批量操作**：对搜索结果执行批量导出、删除等操作
- **结果排除**：可从搜索结果中排除特定记录

## 6.4 导出与备份

### 6.4.1 导出历史记录
将历史记录导出为外部文件格式，便于分享和存档：

#### 导出格式
支持以下导出格式，满足不同使用场景需求：

- **Excel格式 (.xlsx)**：
  - 支持多工作表导出（基本信息/参与数据/结果详情）
  - 自动应用表格样式和格式
  - 支持数据筛选和排序功能
- **CSV格式 (.csv)**：
  - 纯文本表格格式，兼容性强
  - 支持自定义分隔符和编码
  - 适合导入到其他系统
- **JSON格式 (.json)**：
  - 结构化数据格式，适合开发人员使用
  - 包含完整的记录信息
  - 支持格式化输出选项
- **HTML格式 (.html)**：
  - 生成美观的网页报告
  - 包含交互式表格和图表
  - 支持离线浏览
- **PDF格式 (.pdf)**：
  - 适合存档和打印的固定格式
  - 支持添加水印和密码保护
  - 可选择包含详细程度

#### 导出选项
- **导出范围**：
  - 当前选中记录：仅导出列表中选中的记录
  - 搜索结果：导出当前搜索结果中的所有记录
  - 全部记录：导出所有历史记录
  - 时间范围：导出指定时间范围内的记录
- **导出字段**：可自定义导出包含的字段
- **数据筛选**：导出前可对数据进行最后筛选
- **文件命名**：支持自定义导出文件命名规则（含变量）
- **保存位置**：可指定默认导出路径和文件夹

#### 导出流程
1. 在历史记录界面选择"导出"按钮
2. 在导出对话框中选择导出格式
3. 设置导出范围和字段选项
4. 选择保存位置和文件名
5. 点击"导出"按钮开始导出
6. 导出完成后显示结果提示，提供"打开文件"和"打开文件夹"选项

### 6.4.2 备份历史记录
确保历史数据安全，防止意外丢失：

#### 手动备份
- **快速备份**：一键创建完整备份
- **自定义备份**：选择备份内容和位置
- **备份加密**：可选择为备份文件设置密码保护
- **备份验证**：自动验证备份文件完整性

#### 自动备份
- **启用自动备份**：打开/关闭自动备份功能
- **备份频率**：可选择每天/每周/每月/每次退出软件时备份
- **备份保留策略**：
  - 保留最近N个备份
  - 按时间保留（如保留最近30天的备份）
  - 智能保留（重要时间点额外保留）
- **备份位置**：可指定自定义备份文件夹
- **备份通知**：备份完成后的通知方式设置

#### 备份管理
- **备份列表**：显示所有可用备份，包含时间戳和状态
- **备份信息**：显示备份大小、包含记录数、创建时间
- **备份操作**：对选中备份执行恢复、删除、重命名等操作
- **备份存储**：可配置自动上传到云存储（需额外设置）

## 6.5 恢复历史记录

### 6.5.1 从备份恢复
- **恢复流程**：
  1. 在备份管理界面选择要恢复的备份
  2. 点击"恢复"按钮
  3. 在确认对话框中选择恢复选项
  4. 等待恢复完成并查看结果报告
- **恢复选项**：
  - 完全恢复：替换当前所有历史记录
  - 增量恢复：仅添加备份中不存在的记录
  - 选择性恢复：选择要恢复的特定记录
- **恢复前备份**：恢复前自动创建当前数据的备份，防止数据丢失
- **恢复日志**：生成详细的恢复操作日志

### 6.5.2 从历史文件恢复
- **导入历史记录**：从外部历史记录文件导入数据
- **文件格式**：支持从备份文件(.bak)或历史数据库文件(.db)恢复
- **合并策略**：设置与现有记录的合并方式
- **冲突解决**：处理导入过程中遇到的记录冲突

### 6.5.3 恢复验证
- **数据完整性检查**：恢复后自动检查数据完整性
- **记录计数**：显示恢复的记录数量和状态
- **差异报告**：提供恢复前后数据差异的详细报告
- **恢复撤销**：支持撤销最近一次恢复操作

## 6.6 清理历史记录

### 6.6.1 手动清理
- **单条删除**：在记录列表中选择单条记录删除
- **批量删除**：选择多条记录执行批量删除
- **按条件删除**：基于筛选条件删除符合条件的记录
- **删除确认**：所有删除操作均需二次确认
- **删除预览**：显示符合删除条件的记录预览
- **删除恢复**：最近删除的记录可在"回收站"中找回

### 6.6.2 自动清理
- **启用自动清理**：打开/关闭自动清理功能
- **清理规则设置**：
  - 按时间清理：自动删除指定时间前的记录
  - 按数量清理：当记录总数超过指定数量时删除最旧记录
  - 按类型清理：可针对不同类型设置不同清理规则
- **例外设置**：可指定某些记录永不自动清理
- **清理计划**：设置自动清理执行的具体时间
- **清理日志**：记录所有自动清理操作

### 6.6.3 深度清理
- **完全清理**：删除所有历史记录（需多重确认）
- **清理备份**：同时清理相关备份文件
- **数据库优化**：清理后自动优化数据库性能
- **空间释放**：显示清理前后的存储空间占用对比

## 6.7 历史记录安全

### 6.7.1 访问控制
- **查看权限**：可设置查看历史记录的密码保护
- **操作权限**：可单独设置导出/删除等敏感操作的权限
- **权限管理**：多用户环境下的权限分配
- **操作审计**：记录所有历史记录的访问和修改操作

### 6.7.2 数据加密
- **数据库加密**：整体加密保护历史记录数据库
- **敏感字段加密**：对敏感信息单独加密存储
- **加密算法**：采用AES-256加密算法保护数据
- **密钥管理**：安全的加密密钥生成和存储机制

### 6.7.3 隐私保护
- **数据脱敏**：导出时可选择脱敏敏感信息
- **匿名处理**：支持对历史记录进行匿名化处理
- **隐私设置**：控制哪些信息被记录和存储
- **合规模式**：符合数据保护法规的特殊模式

## 6.8 历史记录高级功能

### 6.8.1 数据分析
- **统计概览**：展示历史记录的统计分析图表
- **趋势分析**：显示抽取结果的分布趋势
- **频率分析**：分析特定人员/奖品被抽中的频率
- **报表生成**：创建自定义分析报表

### 6.8.2 批量操作
- **批量导出**：同时导出多条记录
- **批量添加备注**：为多条记录添加相同备注
- **批量标记**：对多条记录进行标记分类
- **批量删除**：按条件删除多条记录

### 6.8.3 历史记录设置
- **记录内容设置**：自定义记录哪些信息
- **存储设置**：调整存储位置和参数
- **界面设置**：自定义历史记录界面布局
- **默认视图**：设置默认的历史记录视图
- **自动刷新**：是否自动刷新历史记录列表

### 6.8.4 数据迁移
- **导入历史**：从旧版本软件导入历史记录
- **格式转换**：转换不同格式的历史记录数据
- **迁移向导**：引导完成历史记录迁移过程
- **迁移验证**：验证迁移后数据的完整性