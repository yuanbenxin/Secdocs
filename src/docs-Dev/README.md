# 故障排除

本章提供SecRandom软件使用过程中可能遇到的各类问题的详细解决方案，帮助您快速诊断并解决问题。如果您遇到的问题未在此处列出，请查阅[常见问题](08_faq/index.md)或联系技术支持。

## 10.1 系统要求与兼容性

### 10.1.1 最低系统要求
- **操作系统**：
  - Windows: Windows 10 64位或更高版本
  - macOS: macOS 10.15 (Catalina)或更高版本
  - Linux: 内核5.4或更高版本的64位系统
- **处理器**：双核1.8GHz或更高
- **内存**：至少2GB RAM
- **硬盘空间**：至少100MB可用空间
- **其他**：显示器分辨率1366×768或更高，互联网连接（仅用于更新和插件下载）

### 10.1.2 推荐系统配置
- **操作系统**：
  - Windows: Windows 11 64位
  - macOS: macOS 12 (Monterey)或更高版本
  - Linux: 内核5.15或更高版本的64位系统
- **处理器**：四核2.5GHz或更高
- **内存**：4GB RAM或更高
- **硬盘空间**：500MB可用空间（含缓存和备份）
- **显卡**：支持OpenGL 3.3或更高版本的显卡（用于高级图形效果）

### 10.1.3 兼容性注意事项
- **Windows**：
  - 不支持Windows XP、Vista、7和8系统
  - 在Windows 10/11家庭版、专业版和企业版上测试通过
  - 兼容Windows Server 2019及以上版本（需启用桌面体验）
- **macOS**：
  - 基于Apple Silicon和Intel芯片的Mac均支持
  - 不支持32位应用模式
- **Linux**：
  官方支持以下发行版：
  - Ubuntu 20.04 LTS及以上
  - Fedora 34及以上
  - Debian 11及以上
  - Arch Linux（最新稳定版）
  - 其他发行版可能需要手动解决依赖问题

## 10.2 安装与启动问题

### 10.2.1 安装失败

#### 错误症状与原因
- **安装程序无法启动**：系统缺少必要的运行时组件
- **安装过程中报错**：权限不足或磁盘空间不足
- **安装完成后无快捷方式**：安装路径包含非ASCII字符或安装被安全软件拦截
- **安装回滚**：系统组件冲突或之前版本未完全卸载

#### 解决方案
1. **运行时组件问题**：
   - 安装[Visual C++ Redistributable 2015-2022](https://aka.ms/vs/17/release/vc_redist.x64.exe)
   - 安装[.NET Framework 4.8](https://dotnet.microsoft.com/download/dotnet-framework/net48)
2. **权限问题**：
   - 右键点击安装程序，选择「以管理员身份运行」
   - 确保当前用户有管理员权限
3. **磁盘空间**：
   - 至少需要100MB可用空间
   - 清理临时文件：运行`cleanmgr.exe`（Windows）或使用系统清理工具
4. **残留文件问题**：
   - 使用[Revo Uninstaller](https://www.revouninstaller.com/)彻底卸载旧版本
   - 手动删除残留文件夹：`C:\Program Files\SecRandom`和`%APPDATA%\SecRandom`
5. **安全软件拦截**：
   - 暂时禁用杀毒软件和防火墙
   - 将安装程序添加到信任列表

### 10.2.2 启动失败

#### 常见错误及解决方法

| 错误信息 | 可能原因 | 解决方案 |
|---------|---------|---------|
| "无法找到Python环境" | Python未安装或环境变量未配置 | 安装Python 3.8-3.11并勾选"Add Python to PATH" |
| "缺少Qt5Core.dll" | Qt运行时未安装 | 安装[Qt5运行时](https://download.qt.io/official_releases/qt/5.15/5.15.2/qt-opensource-windows-x86-5.15.2.exe) |
| "应用程序无法正常启动(0xc000007b)" | 32位与64位版本不匹配 | 下载与系统匹配的软件版本 |
| "数据库连接失败" | 数据库文件损坏 | 删除`%APPDATA%\SecRandom\data.db`后重启软件 |
| 无任何反应 | 配置文件损坏 | 删除`%APPDATA%\SecRandom\config.json`后重启 |

#### 高级诊断步骤
1. **以安全模式启动**：
   - 按住Shift键双击软件图标
   - 选择「安全模式」启动（禁用插件和高级功能）
2. **查看启动日志**：
   - 日志文件位置：`%APPDATA%\SecRandom\logs\startup.log`
   - 查找包含"ERROR"或"EXCEPTION"的行
3. **命令行启动**：
   - 打开命令提示符，导航到安装目录
   - 运行`SecRandom.exe --debug`查看详细输出
4. **系统兼容性疑难解答**：
   - 右键点击可执行文件→「属性」→「兼容性」
   - 勾选「以兼容模式运行这个程序」并选择推荐系统
   - 勾选「以管理员身份运行此程序」

## 10.3 功能使用问题

### 10.3.1 随机选择功能异常

#### 问题表现
- 抽取结果重复率异常高
- 概率设置不生效
- 抽取过程卡顿或无响应
- 结果无法保存

#### 解决方案
1. **重复率问题**：
   - 检查是否启用了"允许重复选择"选项（应在大多数场景下禁用）
   - 确保随机种子未被固定（在高级设置中）
   - 尝试「工具」→「重置随机数生成器」
2. **概率设置问题**：
   - 确认概率总和不为零
   - 检查是否有排除规则冲突
   - 重置为默认概率设置
3. **性能问题**：
   - 名单过大时分会批处理（建议单次不超过10万条）
   - 关闭动画效果（设置→外观→动画效果→关闭）
   - 清理历史记录（历史→清理历史数据）
4. **结果保存问题**：
   - 检查磁盘写入权限
   - 确认磁盘未满
   - 运行「工具」→「修复数据库」

### 10.3.2 数据导入导出问题

#### 导入问题
- **文件格式错误**：确保使用支持的格式（TXT/CSV/XLSX/JSON）
- **编码问题**：使用UTF-8编码保存文件
- **权限问题**：文件可能被其他程序锁定
- **数据格式错误**：检查是否有特殊字符或格式错误

#### 导出问题
- **导出文件为空**：可能筛选条件导致无数据
- **导出失败**：目标路径可能不存在或无写入权限
- **格式错乱**：尝试其他导出格式或更新软件到最新版本

#### 高级解决方案
1. **使用导入向导**：
   - 选择「文件」→「导入」→「导入向导」
   - 按照向导步骤检查并修复文件格式
2. **测试文件诊断**：
   - 使用[示例文件](https://github.com/SECTL/SecRandom/raw/main/examples/sample_list.csv)测试导入功能
   - 如示例文件正常，则问题出在您的文件格式
3. **导出路径问题**：
   - 尝试导出到不同路径（如桌面）
   - 避免使用包含空格或特殊字符的路径
4. **日志分析**：
   - 查看导入/导出日志：`%APPDATA%\SecRandom\logs\io.log`
   - 搜索"ERROR"查找具体问题

## 10.4 性能问题

### 10.4.1 软件卡顿

#### 症状与原因
- 界面响应缓慢
- 操作延迟超过2秒
- 抽取动画卡顿
- 高CPU或内存占用

#### 优化方案
1. **基础优化**：
   - 关闭其他占用资源的程序
   - 重启软件
   - 更新显卡驱动
2. **软件设置优化**：
   - 降低动画质量：设置→外观→动画质量→低
   - 减少历史记录保留：设置→历史记录→保留最近3个月
   - 禁用不必要的插件：设置→插件→禁用未使用的插件
3. **大数据优化**：
   - 名单超过10万条时启用分页加载
   - 使用筛选功能减少当前显示数据量
   - 定期清理无用名单
4. **系统优化**：
   - 增加虚拟内存：系统属性→高级→性能→设置→高级→虚拟内存→更改
   - 磁盘碎片整理（机械硬盘）
   - 关闭Windows索引服务（针对软件安装目录）

### 10.4.2 内存占用过高

#### 问题分析
SecRandom正常运行时内存占用通常在50-200MB之间，如持续超过500MB则属于异常情况。

#### 解决方案
1. **内存泄漏问题**：
   - 更新到最新版本（许多内存泄漏问题会在新版本中修复）
   - 定期重启软件释放内存
2. **大数据集处理**：
   - 将超过10万条的名单拆分为多个小名单
   - 使用「分批处理」模式
3. **诊断内存问题**：
   - 启用内存监控：设置→高级→开发者选项→内存监控
   - 记录哪些操作导致内存急剧增加
   - 将内存日志发送给技术支持：support@secrandom.org

## 10.5 高级故障排除

### 10.5.1 数据库问题

#### 常见数据库错误
- **数据库损坏**：软件可能无法启动或数据丢失
- **数据库锁定**：无法写入数据或操作卡顿
- **数据库过大**：性能下降

#### 数据库修复步骤
1. **备份数据**（如可能）：
   - 复制`%APPDATA%\SecRandom\data.db`到安全位置
2. **使用内置修复工具**：
   - 启动软件→设置→高级→数据库维护→修复数据库
3. **手动修复**：
   - 下载并安装[SQLite Studio](https://sqlitestudio.pl/)
   - 打开数据文件：`%APPDATA%\SecRandom\data.db`
   - 执行维护命令：`PRAGMA integrity_check;`
   - 如发现错误，执行：`PRAGMA repair;`
4. **重建数据库**：
   - 导出所有数据：文件→导出所有数据
   - 删除损坏的数据库文件
   - 重启软件创建新数据库
   - 导入之前导出的数据

### 10.5.2 高级日志分析

#### 日志文件位置
- **Windows**：`%APPDATA%\SecRandom\logs`
- **macOS**：`~/Library/Logs/SecRandom`
- **Linux**：`~/.local/share/SecRandom/logs`

#### 关键日志文件
- `startup.log`：启动过程日志
- `error.log`：错误日志
- `debug.log`：调试日志（需在设置中启用）
- `io.log`：导入/导出操作日志
- `plugin.log`：插件相关日志

#### 日志分析工具
- 使用[Log Viewer](https://www.logviewer.com/)打开日志文件
- 搜索关键词：ERROR, WARNING, EXCEPTION, FAILED
- 分析错误发生时间和上下文
- 将相关日志片段发送给技术支持

### 10.5.3 命令行工具

SecRandom提供命令行工具用于故障排除：

```bash
# 检查系统兼容性
SecRandom-cli --check-system

# 验证安装完整性
SecRandom-cli --verify-install

# 修复数据库
SecRandom-cli --repair-db

# 导出数据（紧急恢复）
SecRandom-cli --export-data backup.zip

# 查看软件信息
SecRandom-cli --info

# 启用调试模式并启动
SecRandom-cli --debug
```

## 10.6 获取技术支持

### 10.6.1 准备支持请求

联系技术支持前，请准备以下信息：
1. 软件版本（帮助→关于→版本信息）
2. 操作系统版本及位数
3. 问题复现步骤
4. 错误截图（如可能）
5. 相关日志文件
6. 系统信息：运行`msinfo32.exe`（Windows）并保存报告

### 10.6.2 支持渠道

- **GitHub Issues**：[提交问题](https://github.com/SECTL/SecRandom/issues)（推荐）
  - 提供详细问题描述和复现步骤
  - 附上相关日志和截图
  - 标签使用：`bug`, `help-wanted`, `support`

- **邮件支持**：support@secrandom.org
  - 邮件主题格式：`[支持请求] 简短问题描述`
  - 附件包含必要的日志和截图

- **社区论坛**：[forum.secrandom.org](https://forum.secrandom.org)
  - 在「技术支持」板块发布问题
  - 提供详细信息，以便其他用户和开发者帮助解决

- **实时支持**（高级用户）：
  - 加入Discord服务器：[discord.gg/secrandom](https://discord.gg/secrandom)
  - 工作日9:00-18:00提供实时支持

### 10.6.3 远程协助

对于复杂问题，可申请远程协助：
1. 在GitHub Issues或邮件中请求远程协助
2. 提供基本系统信息和问题描述
3. 技术人员会回复可用时间段
4. 通过[TeamViewer](https://www.teamviewer.com/)或[AnyDesk](https://anydesk.com/)进行远程协助
5. 协助过程会全程记录，保护用户隐私

## 10.7 常见问题参考

如遇到其他问题，可参考以下资源：
- [常见问题（FAQ）](08_faq/index.md)章节
- [GitHub问题库](https://github.com/SECTL/SecRandom/issues?q=is%3Aissue+is%3Aclosed)（已解决问题）
- [知识库文章](https://docs.secrandom.org/knowledge-base)
- [视频教程](https://www.youtube.com/playlist?list=PLkMf14VQJ0-7kTPHhJnJjG3eJhHcGQJ8s)（包含常见问题解决方法）

如果您发现了软件bug，请通过GitHub Issues报告，帮助我们改进软件。报告时请包含详细的复现步骤、系统信息和相关日志。